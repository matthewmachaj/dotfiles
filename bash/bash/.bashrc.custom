#===================================================================================
# Editor/vi Setup
#===================================================================================
set -o vi

export EDITOR="vi"
export FCEDIT="vi"

# Sets default editor for various systems programs like crontab & git
export VISUAL="vi"

# Alter prompt if in SHELL via Vim
# SEE: https://stackoverflow.com/a/19124531/14209903
if [ "$VIM" ]; then
  PS1="${MM_RED}(vim)${NC}${PS1}"
fi

#===================================================================================
# Custom Bash Additions
#===================================================================================
#--------------------------------------------------------------
# Alter prompt if session is remote
#--------------------------------------------------------------
# See: https://unix.stackexchange.com/a/9607/408519
if [ -n "$SSH_CLIENT" ] || [ -n "$SSH_TTY" ]; then
  SESSION_TYPE=remote/ssh
else
  case $(ps -o comm= -p $PPID) in
    sshd|*/sshd) SESSION_TYPE=remote/ssh;;
  esac
fi

#  Search '/PROMPTING' in `man bash` for info on PS1 prompt variables
if [ "$SESSION_TYPE" = "remote/ssh" ]; then
  # Change Green (32) -> Purple (35) or Red (31)
  #  export PS1=$(echo "$PS1" | sed 's/1;32m/1;31m/')
  export PS1="${MM_PURPLE}[ssh]${NC}${PS1}"
fi

#--------------------------------------------------------------
# Bashmarks directory completion tool
#--------------------------------------------------------------
if [[ $(command -v l | grep alias) ]]; then
  unalias l 				# required for bashmarks b/c 20.04 .bashrc sets this alias
fi
if [ -f ~/.local/bin/bashmarks.sh ]; then
  source ~/.local/bin/bashmarks.sh
fi

#--------------------------------------------------------------
# Source LastPass CLI bash completion
#--------------------------------------------------------------
test -f /usr/share/bash-completion/completions/lpass && source /usr/share/bash-completion/completions/lpass

#--------------------------------------------------------------
# Setup Base16 Shell
# https://github.com/chriskempson/base16-shell
#--------------------------------------------------------------
BASE16_SHELL="$HOME/.config/base16-shell/"
[ -n "$PS1" ] && \
    [ -s "$BASE16_SHELL/profile_helper.sh" ] && \
        eval "$("$BASE16_SHELL/profile_helper.sh")"

#-----------------------------------------------------------------------------------
# For later...
#-----------------------------------------------------------------------------------
#--------------------------------------------------------------
# SSH Autocomplete
#--------------------------------------------------------------
# Will autocomplete any hosts found in known_hosts.
# From: https://gist.github.com/peelman/1773863
complete -W "$(echo `cat ~/.ssh/known_hosts | cut -f 1 -d ' ' | sed -e s/,.*//g | uniq | grep -v "\["`;)" ssh


#--------------------------------------------------------------
# (mm) nodeenvwrapper setup
#--------------------------------------------------------------
#source ~/dotfiles/files/nodeenvwrapper.sh

#--------------------------------------------------------------
# autoenv Setup
#--------------------------------------------------------------
# autoenv - modifies 'cd' to execute '.env' when cd'ing to a directory with a '.env' file
#  - https://github.com/kennethreitz/autoenv
#source ~/.autoenv/activate.sh


#--------------------------------------------------------------
# CHEF
#--------------------------------------------------------------
# autocomplete for Knife
# https://github.com/wk8/knife-bash-autocomplete
#source knife_autocomplete.sh
